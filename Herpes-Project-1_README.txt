Herpes-Project-1 "Project 1: Incident HSV-2 and genital health in Kenyan adolescent girls: an inception cohort"



##Experiment outline: Explant samples


We infected vaginal biopsy explants from 7 donors with two strains of HSV-2 (SD90 and V186). We also did a Mock infection on an explant from each donor. In the code, these treatments are referred to as SD90, V186 and Mock. Donors are identified by a unique 3 digit TissueID.

RNA was isolated from the explants at 3 timepoints after infection: 3 hours, 8 hours and 24 hours. In the code, results from treatment and timepoint conditions are specified as `treatment.timepoint` (ex. V186.3 is the V186 treatment at the 3hr post infection timepoint).


We used the Qiagen RNeasy fibrous tissue kit to extract and purify the RNA. We used the NuGEN Ovation PicoSL WTA System V2 to make and amplify cDNA and the NuGEN Encore BiotinIL Module to label the cDNA with biotin. The samples were sent to the FHCRC genomics core facility to be spotted on Illumina Human HT12 v4 beadchip arrays. Samples (one sample is a single TissueID x Treatment x Timepoint) were named with random numbers from 6-69.

Epithelial samples

A companion study using the same scheme but with immortalized lines of primary vaginal epithelial cells from three donors was analyzed by different methods, but I reanalyzed it using the same methods as for the explants, starting from the the raw microarray data that Lamar Fleming got from the FHCRC core services. For this study, (epithelial cells ony) the 0.1 MOI was 800,000 PFU per flask.


##Analysis outline
I used lumi to read in the raw microarray data from the text files we got from core services. Then I did the differential expression analysis with limma and generated lists of probes to put into the InnateDB website (www.innatedb.com) for Gene Ontology (GO) and over-representation analyses. I used the CAMERA function in limma for gene set testing. SessionInfo() is at the end of the scripts to document software/package versions.




FOLDERS AND FILES IN HERPES-PROJECT-1 DIRECTORY: sorted by NAME


#### RAW INPUT, INNATE DB INPUT, INNATE DB RESULTS, KNITR/MARKDOWN GENERATED FILES ##########
CAMERA_gene_set_testing_cache:
	These are files that knitr cached when knitting the CAMERA gene set testing script.
CAMERA_gene_set_testing_output
	These are results from testing some collections from MSigDB, in .csv format. See the CAMERA_gene_set_testing_README for more info on how I did this.

data from LMF analysis of epi cells
	Files that I got from Lamar that resulted from her analysis of the epithelial cell data. These 	are the only files in the directory that are from Lamar's analysis; all others are from mine.

IDBinput
	These are files from both explant and epithelial cell experiments that I put into the Innate DB website (www.innatedb.com) for over-representation analyses. They were written out from the R following R scripts: markdown_vaginal_cell_microarray
	markdown_vaginal_explant_microarray
	The date I accessed InnateDB is in the scripts.

INNATE DB RESULTS
	Excel for FH from IDB
		explant:
		These are excel files that I generated from the output I got from IDB. I read text files in from IDB, then moved them to excel so FH could manipulate them. These are only files from explant analyses. "forExcelShortGeneIDBdata.txt" is written out from the markdown_vaginal_explant_microarray script 
		
	geneSpreadsheets: This is the raw text output from IBD Gene Ontology analyses (GO annotation, not ORA)
		CELLS:results from epithelial cell analyses
		explant: results from explant analyses
		
	oraSpreadsheets: This is the raw text output from IDB over-representation analyses.
		files starting with "GO" are Ontology over-representation analyses
		files starting with "pathway" are pathway over-representation analyses
		
	Plots: IDB generated plots of the above analyses
	
	Screenshots: These are 2 screen shots showing the difference in column names in downloaded data vs. when you are looking at in on the website. There are more notes about this in the markdown_vaginal_cell_microarray script.

markdown_vaginal_cell_microarray_files: image files that go with the .md generated from the markdown_vaginal_cell_microarray.Rmd script

markdown_vaginal_explant_microarray_cache:These are files that knitr cached when knitting the markdown_vaginal_explant_microarray script.

markdown_vaginal_explant_microarray_files: image files that go with the .md generated from the markdown_vaginal_explant_microarray.Rmd script.

MSigDB_gene_sets
	These are gene set collections in .Rdata format that I downloaded from here: http://bioinf.wehi.edu.au/software/MSigDB/

phenoDataInput: phenoData text files for both epithelial and explant experiments. These data are read in in the beginning of the script and are used by limma as metadata.

RdataOutput: These are .Rda files generated by the markdown_vaginal_cell_microarray and markdown_vaginal_explant_microarray scripts. They are useful if you want to run a part of the analysis without having to start from the beginning and redo raw data processing.

subset_vaginal_explant_microarray:
	INNATE DB RESULTS
		Excel for FH based on geneSpreadsheets: excel files for FH to manipulate, generated from plain txt files in geneSpreadsheets
		
		Excel for FH based on oraSpreadsheets: excel files for FH to manipulate, generated from plain txt files in oraSpreadsheets
		
		geneSpreadsheets: raw text output from Gene Ontology analysis from IDB (not ORA). I read these into the subset_vaginal_explant_microarray script, and then wrote out
		"forExcelShortGeneIDBdata.txt" . Then I opened this txt file in excel to make the excel files for FH. 
		
		oraSpreadsheets: This is the raw text output from IDB over-representation analyses.
		files starting with "GO" are Ontology over-representation analyses
		files starting with "pathway" are pathway over-representation analyses
		
	R files in this folder are generated by the subset_vaginal_explant_microarray script and re useful if you want to run a part of the analysis without having to start from the beginning and redo raw data processing.

	IDBinput: .txt files to input into the IDB website for analyses.
	subset_vaginal_explant_microarray_cache:These are files that knitr cached when knitting the subset_vaginal_explant_microarray script.
	subset_vaginal_explant_microarray_files: image files that go with the .md generated from the subset_vaginal_explant_microarray.Rmd script
	
	
	
vaginal_cell_microarray_Illumina
	FinalReport_HSV2_HVE MA : This is the raw data for the epithelial cell experiment.
	From LMF_SampleTable for HSV2_HVE: This is a file that Lamar gave me that connects the sample name that was used on the microarray with the meta data for the experiment. I based my vaginalCellMicroarrayPhenoData.txt file (the one I actually read into limma) on this file.

vaginal_explant_microarray_Illumina: This folder is analogous to vaginal_cell_microarray_Illumina in that it contains the raw microarray data from core services
	2015_11_10
	GenomeStudioProject
		SeanHughes_HumanHT12v4_151112
			2015.11.12smhughesFinalReport.txt : This is  the actual file to read into lumi!!!

#### SCRIPTS #######
CAMERA_gene_set_testing: This is a stand-alone script that only has gene set testing (using limma's CAMERA function) for the explant data. The same code is in the markdown_vaginal_explant_microarray script, but I made this standalone so I could make a nice html file to send to FH.

markdown_vaginal_explant_microarray: This script has all of the analysis of the explant experiment data. 

markdown_vaginal_cell_microarray: This script has all of the analyses of the epithelial cell experiment data.

subset_vaginal_explant_microarray: This script is an analysis of just a subset of the vaginal explant data, details about the subset are in the script comments.


	